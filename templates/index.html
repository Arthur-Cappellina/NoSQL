<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recherche de Protéines</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <h1>Base de données des protéines</h1>
        <nav>
            <a href="/" class="selected">Database</a>
            <a href="/graph">Graph</a>
            <a href="/stats">Stats</a>
        </nav>
    </header>
    <main>
        <section>
            <h2>Rechercher une protéine</h2>
            <form id="search-form">
                <label for="search-type">Type de recherche :</label>
                <select id="search-type" name="search-type" required>
                    <option value="id">Identifiant</option>
                    <option value="name">Nom</option>
                    <option value="description">Description</option>
                    <option value="id-name">Identifiant ou nom</option>
                    <option value="id-description">Identifiant ou description</option>
                    <option value="name-description">Nom ou description</option>
                    <option value="id-name-description">Identifiant, nom ou description</option>
                </select>
                <label for="search-input">Valeur :</label>
                <input type="text" id="search-input" name="search-value" placeholder="Entrez la valeur de recherche" required>

                <label for="db-choice">Base de données :</label>
                <select id="db-choice" name="db-choice" required>
                    <option value="mongodb">MongoDB</option>
                    <option value="neo4j">Neo4j</option>
                </select>

                <button type="submit">Rechercher</button>
            </form>
            <div id="results"></div>
        </section>
    </main>
    <footer>
        &copy; 2025 - Projet NoSQL Protein DB
    </footer>
    <script>
        document.getElementById("search-form").addEventListener("submit", function(event) {
            event.preventDefault();

            // Récupération du type de recherche et de la valeur entrée
            const searchType = document.getElementById("search-type").value;
            const searchValue = document.getElementById("search-input").value;
            const db_type = document.getElementById("db-choice").value;

            if (!searchValue) {
                alert("Veuillez entrer une valeur pour la recherche.");
                return;
            }

            // Requête vers le serveur avec les paramètres
            fetch(`/query_db?type=${searchType}&value=${searchValue}&db=${db_type}`)
                .then(response => response.json())
                .then(data => {
                    const resultsDiv = document.getElementById("results");
                    resultsDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                })
                .catch(error => {
                    console.error("Erreur lors de la recherche :", error);
                    document.getElementById("results").innerText = "Une erreur est survenue. Veuillez réessayer.";
                });
        });
    </script>
</body>
</html>
